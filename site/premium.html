<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Premium aktivieren – Epstein Files</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
<div class="topbar">
  <div class="container">
    <div class="row">
      <div class="badge"><span class="dot"></span><strong>Live</strong> · <span id="today"></span></div>
      <div class="badge">Status: <span id="authState">Gast</span> · <a href="#" id="logoutBtn" style="display:none">Logout</a></div>
    </div>
  </div>
</div>

<div class="masthead">
  <div class="container">
    <div class="inner">
      <div class="logo">
        EPSTEIN FILES
        <small>Index + Leseführung für öffentlich zugängliche Quellen · Premium: Highlights, Smart‑Match, Namen‑Index</small>
      </div>
      <div class="actions">
        <a class="btn" href="/admin.html">Admin</a>
        <a class="btn primary" href="#" data-subscribe>Freischalten <small>ab €1,99</small></a>
      </div>
    </div>
  </div>
</div>

<div class="nav">
  <div class="container">
    <div class="row">
      <a href="/">Start</a>
      <a href="/search.html">Suche</a>
      <a href="/names.html">Namen‑Index</a>
      <a href="/about.html">Methode</a>
      <a href="/partners.html">Partner</a>
    </div>
  </div>
</div>

<main class="container">
  <div class="card pad" style="margin-top:16px">
    <div class="kicker">Premium</div>
    <div class="h2">Aktivierung läuft…</div>
    <div class="p muted" id="msg">Bitte warten.</div>
  </div>
</main>

<script type="module">
  import { apiGet, setToken } from "/js/api.js";
  import { boot } from "/js/render.js";

  function qs(s){return document.querySelector(s)}

  boot("premium").then(async ()=>{
    const params = new URLSearchParams(location.search);
    const session_id = params.get("session_id");
    if (!session_id) { qs("#msg").textContent = "Fehlende session_id."; return; }

    const out = await apiGet(`/api/activate?session_id=${encodeURIComponent(session_id)}`);
    if (!out.success) { qs("#msg").textContent = out.error || "Aktivierung fehlgeschlagen."; return; }

    setToken(out.token);
    qs("#msg").innerHTML = `✅ Premium aktiv bis <strong>${new Date(out.expires_at).toLocaleString("de-DE")}</strong>. Weiterleitung…`;
    setTimeout(()=>location.href="/", 900);
  });
</script>

<div class="footer">
  <div class="container">
    <div class="row">
      <div>© <span id="year"></span> Wissens‑Bank. <span class="muted">Recherche‑Index & Leseführung.</span></div>
      <div style="display:flex;gap:12px;flex-wrap:wrap">
        <a href="/impressum.html">Impressum</a>
        <a href="/datenschutz.html">Datenschutz</a>
        <a href="/agb.html">AGB</a>
      </div>
    </div>
    <div style="margin-top:10px" class="p small muted">
      Hinweis: Wir hosten keine urheberrechtlich geschützten Inhalte Dritter. Wir verlinken auf Quellen und erstellen Zusammenfassungen/Leseführung.
    </div>
  </div>
</div>
<script>document.getElementById("year").textContent = new Date().getFullYear();</script>


<!-- Deployed with Zip-Ship -->
<div id="zipship-badge" style="position:fixed;bottom:12px;right:12px;z-index:9999;font-family:system-ui,sans-serif;font-size:12px;">
  <a href="https://zip-ship-revolution.com/?utm_source=user_site" target="_blank" rel="noopener" 
     style="display:flex;align-items:center;gap:6px;padding:6px 12px;background:rgba(10,14,39,0.85);color:#00F0FF;text-decoration:none;border-radius:6px;border:1px solid rgba(0,240,255,0.3);backdrop-filter:blur(8px);transition:all 0.2s;">
    <span style="font-size:14px;">⚡</span>
    <span>Deployed with Zip-Ship</span>
  </a>
</div>
</body>
</html>
